                          Server settings deploy



1. Open Terminal; required only gitbash terminal, does not work on other terminals


	- ssh <server-user@server-domen> : for example; 
			ssh root@test.uz
				
------------------------------------------------------	
	
	- password: you don't see it
			password: %87dw87dsad7h8sd7g
-----------------------------------------------------
	then; for axample

Linux nliuusupor 5.10.0-23-cloud-amd64 #1 SMP Debian 5.10.179-2 (2023-07-14) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Tue Aug  8 17:23:54 2023 from 185.213.229.54
root@nliuusupor:~#
		
	if these entries appear in the terminal, everything is OK!

----------------------------------------------------

	~ = this home folder
	
	- write "ls"
-cli  dump.rdb  node_modules  yarn.lock
----------------------------------------------------

	cd ../ 
		- cd ../ through which we exit the folder 1 time
---------------------------------------------------
/#  - this root folder

	ls
apps  boot  etc   lib    lib64   lost+found  mnt  proc  run   srv  tmp  var
bin   dev   home  lib32  libx32  media       opt  root  sbin  sys  usr
--------------------------------------------------
			either create a new folder or work in the "home" folder
--------------------------------------------------

cd /apps/
	- enter the folder
--------------------------------------------------
ls
	For_Example   fake-api  lms  todos-api
--------------------------------------------------

pm2 module - helps to see and work on the processes running on the server, it is similar to nodemon, the difference is that it does not keep the server busy or block
--------------------------------------------------
pm2 list
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”
â”‚ id â”‚ name        â”‚ namespace   â”‚ version â”‚ mode    â”‚ pid      â”‚ uptime â”‚ â†º    â”‚ status    â”‚ cpu      â”‚ mem      â”‚ user     â”‚ watching 
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”¤
â”‚ 1  â”‚ forExample â”‚ default     â”‚ N/A     â”‚ fork    â”‚ 400126   â”‚ 40h    â”‚ 1    â”‚ online    â”‚ 0%       â”‚ 76.5mb   â”‚ root  disabled    â”‚
â”‚ 0  â”‚ server      â”‚ default     â”‚ 1.0.0   â”‚ fork    â”‚ 0        â”‚ 0      â”‚ 15   â”‚ stopped   â”‚ 0%       â”‚ 0b       â”‚ root     â”‚ disabled 
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”˜

-------------------------------------------------
stop the server!

pm2 stop For_example

[PM2] Applying action stopProcessId on app [For_example](ids: [ 1 ])
[PM2] [datashop](1) âœ“

â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”
â”‚ id â”‚ name        â”‚ namespace   â”‚ version â”‚ mode    â”‚ pid      â”‚ uptime â”‚ â†º    â”‚ status    â”‚ cpu      â”‚ mem      â”‚ user     â”‚ watching 
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”¤
â”‚ 1  â”‚ forExample  â”‚ default     â”‚ N/A     â”‚ fork    â”‚ 400126   â”‚ 40h    â”‚ 1    â”‚ stopped    â”‚ 0%       â”‚ 76.5mb   â”‚ root  disabled    â”‚
â”‚ 0  â”‚ server      â”‚ default     â”‚ 1.0.0   â”‚ fork    â”‚ 0        â”‚ 0      â”‚ 15   â”‚ stopped   â”‚ 0%       â”‚ 0b       â”‚ root     â”‚ disabled 
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”˜

-------------------------------------------------
next delete the folder;
rm -r For_Example/
	- delete folder
------------------------------------------------
Delete folder from pm2 list

pm2 delete forExample


â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”
â”‚ id â”‚ name      â”‚ namespace   â”‚ version â”‚ mode    â”‚ pid      â”‚ uptime â”‚ â†º    â”‚ status    â”‚ cpu      â”‚ mem      â”‚ user     â”‚ watching â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”¤
â”‚ 0  â”‚ server    â”‚ default     â”‚ 1.0.0   â”‚ fork    â”‚ 0        â”‚ 0      â”‚ 15   â”‚ stopped   â”‚ 0%       â”‚ 0b       â”‚ root     â”‚ disabled â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”˜

---------------------------------------------------------------------

	-Pulling a new project from github

git clone https://github.com/github_profil/repostrory_name.git

Cloning into 'repostrory_name'...
remote: Enumerating objects: 746, done.
remote: Counting objects: 100% (746/746), done.
remote: Compressing objects: 100% (493/493), done.
remote: Total 746 (delta 406), reused 568 (delta 229), pack-reused 0
Receiving objects: 100% (746/746), 195.84 KiB | 1.17 MiB/s, done.
Resolving deltas: 100% (406/406), done.
---------------------------------------------------------------

	- Let's check the folders
ls

For_Example  fakenote-api  lms  todos-api

-------------------------------------------------------


	- Enter the folder

cd For_Example/

 package.json   package-lock.json   prisma   readme   src   tsconfig.json
----------------------------------------------------------

	- Create new file

touch .env
----------------------------------------------------------
	- We see a list of folders

ls

package.json   package-lock.json   prisma   readme   src   tsconfig.json

There is no .env file 

because the folders or files preceded by a dot are not visible on Linux
-------------------------------------------------------

	- to view hidden files

ls -a

    .git      .gitignore     package-lock.json   readme   tsconfig.json
    .env   .github   package.json   prisma              src
------------------------------------------------------
	- There are standard editors in the terminal; these are; nano, vim, emacs

	- we use nano because it is easy to use and very simple

	- Let's configure the env file

nano .env

DATABASE_URL="postgresql://postgres:1@localhost:5432/data_shop?schema=public"

JWT_SECRET=jwt-secret
EXPIRES_IN=3000h
PORT=9060
JWT_ENGINE=local
ATTACHMENTS_PATH=./files/attachments
TEMPS_PATH=./files/temps

VERIFICATION_TIMEOUT=3000
SECRET_KEY="san skjfnsdkjfs"

EMAIL="test@gmail.com"
EMAIL_PASSWORD="luepoegafwuqicis"

--------------------------------------------------------


	- Create new user for database control

create user john with password '1234' superuser;

CREATE ROLE

psql -U "username"

Password for user "1234":
psql (13.11 (Debian 13.11-0+deb11u1))
Type "help" for help.

"username"=#
--------------------------------------------------------

create database blabla;

if you want delete database;

drop database blabla;
DROP DATABASE

create database blabla;
CREATE DATABASE
------------------------------------------------

exit postgres 

\q
-----------------------------------------


	- We will create a new folder to upload images

mkdir upload

---------------------------------------------

	- Install moduls

npm install

added 281 packages, and audited 282 packages in 6s

25 packages are looking for funding
  run `npm fund` for details

2 moderate severity vulnerabilities

Some issues need review, and may require choosing
a different dependency.
------------------------------------------

	- Next create database tables

npx prisma db push

Environment variables loaded from .env
Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "data_shop", schema "public" at "localhost:5432"

ğŸš€  Your database is now in sync with your Prisma schema. Done in 116ms

âœ” Generated Prisma Client (4.16.2 | library) to ./node_modules/@prisma/client in 336ms
------------------------------------------------

Next we compile typescript to javascript

For this, the package.json file must contain a build script

npm run build

npm start
------------------------------

the server should work without blocking even after we close the terminal, we use pm2 for this

pm2 start -name 'project_name' npm  -- start

[PM2] Starting /usr/bin/npm in fork_mode (1 instance)
[PM2] Done.
+--- -a
namespace : default
version : N/A
pid : 461362
pm2 id : 0
status : online
mode : fork
restarted : 0
uptime : 0s
memory usage : 16.1mb
error log : /apps/Data_Shop/datashop
watching : no
PID file : /root/.pm2/pids/-a-0.pid

----------------------------------

pm2 list


â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”
â”‚ id â”‚ name      â”‚ namespace   â”‚ version â”‚ mode    â”‚ pid      â”‚ uptime â”‚ â†º    â”‚ status     â”‚ cpu      â”‚ mem      â”‚ user     â”‚ watching â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”¤
â”‚ 0  â”‚ -a    â”‚ default     â”‚ 1.0.0  	  â”‚ fork    â”‚ 0          â”‚ 0              â”‚ 15   â”‚ stopped   â”‚ 0%       â”‚ 0b       â”‚ root     â”‚ disabled â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”˜
---------------------------------------------

pm2 show 0

	- "0 = id"

 Describing process with id 0 - name -a
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ status            â”‚ online                     â”‚
â”‚ name              â”‚ -a                         â”‚
â”‚ namespace         â”‚ default                    â”‚
â”‚ version           â”‚ N/A                        â”‚
â”‚ restarts          â”‚ 0                          â”‚
â”‚ uptime            â”‚ 27s                        â”‚
â”‚ script path       â”‚ /usr/bin/npm               â”‚
â”‚ script args       â”‚ start                      â”‚
â”‚ error log path    â”‚ /apps/Data_Shop/datashop   â”‚
â”‚ out log path      â”‚ /root/.pm2/logs/-a-out.log â”‚
â”‚ pid path          â”‚ /root/.pm2/pids/-a-0.pid   â”‚
â”‚ interpreter       â”‚ node                       â”‚
â”‚ interpreter args  â”‚ N/A                        â”‚
â”‚ script id         â”‚ 0                          â”‚
â”‚ exec cwd          â”‚ /apps/Data_Shop            â”‚
â”‚ exec mode         â”‚ fork_mode                  â”‚
â”‚ node.js version   â”‚ 18.16.1                    â”‚
â”‚ node env          â”‚ N/A                        â”‚
â”‚ watch & reload    â”‚ âœ˜                          â”‚
â”‚ unstable restarts â”‚ 0                          â”‚
â”‚ created at        â”‚ 2023-08-11T08:21:56.641Z   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 Actions available
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ km:heapdump            â”‚
â”‚ km:cpu:profiling:start â”‚
â”‚ km:cpu:profiling:stop  â”‚
â”‚ km:heap:sampling:start â”‚
â”‚ km:heap:sampling:stop  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 Trigger via: pm2 trigger -a <action_name>

 Code metrics value
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Used Heap Size         â”‚ 16.57 MiB â”‚
â”‚ Heap Usage             â”‚ 85.65 %   â”‚
â”‚ Heap Size              â”‚ 19.35 MiB â”‚
â”‚ Event Loop Latency p95 â”‚ 0.92 ms   â”‚
â”‚ Event Loop Latency     â”‚ 0.23 ms   â”‚
â”‚ Active handles         â”‚ 5         â”‚
â”‚ Active requests        â”‚ 0         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 Divergent env variables from local env

------------------------------------------------

	- Rename server

pm2 restart 0 --name safer

-----------------------------------

	- show nginx work

nginx 

systemctl status nginx
 




								COMMANDS!

~ = home folder 

/# = root folder

pm2 module - project manager 2 - this module helps to work with the processes running on the server

pm2 stop "server name"



1. clear - tozalash(tozalash jarayoni serverga aloqasi yo'q)

2. ls =  this command outputs a list of folders

3. cd ../  = through which we exit the folder 1 time

4. rm = delete folder

5. rm -r = ...and deletes the folder and everything inside it

6. touch = for create new file

7. mkdir = for create new folder